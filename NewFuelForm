using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using MySql.Data.MySqlClient;

namespace VehicleMonitoringSystem
{
    public partial class NewFuelForm : Form
    {
        #region Variable
        private int fuelID,
                    supplierID;
        private string plateNumber,
                       vehicle,
                       typeOfFuel,
                       invoiceNumber;
        private bool paid;

        private DateTime date;
        private double amount;
        private Fuel _fuel = new Fuel();
        private Supplier _supplier = new Supplier();
        private List<Fuel> _fuels = new List<Fuel>();
        #endregion

        #region  Constructors
        public NewFuelForm()
        {
            InitializeComponent();
            fuelIDTB.Text = _fuel.CreateFuel().ToString();
            ComboBoxLoad();
        }
        #endregion

        #region Gas Methods
        private void ShowData(string plateNumber)
        {
            _fuel = _fuel.RetrieveFuelInfo(plateNumber);

            fuelIDTB.Text = _fuel.FuelID.ToString();
            plateNumberCB.Text = _fuel.PlateNumber;
            dateDTP.Value = _fuel.FuelDate;
            typeOfFuelCB.Text = _fuel.TypeOfFuel;
           // supplierCB.Text = _fuel.SupplierID;
            amountTB.Text = _fuel.Amount.ToString("N2");
            paidTB.Text = _fuel.Paid.ToString();
        }

        private void NewFuelForm_Load(object sender, EventArgs e)
        {

        }

        private void addB_Click(object sender, EventArgs e)
        {
            NewSupplierForm newSupplierForm = new NewSupplierForm();
            newSupplierForm.ShowDialog();
        }

        private void ComboBoxLoad()
        {
            _fuels = _fuel.RetrieveFuelList();
            foreach (Fuel f in _fuels)
            {
                plateNumberCB.Items.Add(f.PlateNumber);
                typeOfFuelCB.Items.Add(f.TypeOfFuel);
               // supplierCB.Items.Add(f.Supplier);
               // paidTB.Items.Add(f.Paid);
            }
        }


        //Entry Buttons
        private void saveB_Click(object sender, EventArgs e)
        {
            try
            {
                fuelID = int.Parse(fuelIDTB.Text.Trim());
                plateNumber = plateNumberCB.Text.Trim();
                supplierID = _supplier.RetrieveSupplierID(supplierCB.Text.Trim());
                vehicle = vehicleCB.Text.Trim();
                date = dateDTP.Value;
                typeOfFuel = typeOfFuelCB.Text.Trim();
                amount = double.Parse(amountTB.Text.Trim());
                paid = bool.Parse(paidTB.Text.Trim());


                _fuel = new Fuel(fuelID,
                                 plateNumber,
                                 supplierID,
                                 date,
                                 typeOfFuel,
                                 invoiceNumber,
                                 amount,
                                 paid);

                _fuel.InsertFuel(_fuel);
                Close();
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.ToString());
            }
        }
        private void cancelB_Click(object sender, EventArgs e)
        {
            Close();
        }
        private void clearB_Click(object sender, EventArgs e)
        {
            plateNumberCB.Text = "";
            vehicleCB.Text = "";
            dateDTP.Value = DateTime.Now;
            typeOfFuelCB.Text = "";
            supplierCB.Text = "";
            amountTB.Text = "";
            paidTB.Text = "";
        }
        #endregion
    }
}
